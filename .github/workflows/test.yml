name: Go

on:
  push:
    branches-ignore:
      - main
  pull_request:
    branches: [ "main" ]

jobs:
  prepare:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 0  # ğŸ”¹ ç¡®ä¿ Git å†å²å®Œæ•´

    - name: Fix HEAD issue
      run: git checkout $(git rev-parse HEAD)  # ğŸ”¹ ç¡®ä¿ HEAD æœ‰æ•ˆ
  
    - name: Fetch all branches
      run: git fetch --prune  # âœ… ç§»é™¤ --unshallowï¼Œé¿å…é”™è¯¯
    
    - name: gitlint
      run: make gitlint

  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 0  # ğŸ”¹ ç¡®ä¿ Git å†å²å®Œæ•´



    - name: Build
      run: go version